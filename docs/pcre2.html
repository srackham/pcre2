<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="x-ua-compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>pcre2 | vdoc</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel="stylesheet">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  
		<link rel="stylesheet" href="doc.css" />
		<link rel="stylesheet" href="normalize.css" />
		<script src="dark-mode.js"></script>
</head>

<body>
  <div><a id="skip-to-content-link" href="#main-content">Skip to content</a></div>
  <div id="page">
    <header class="doc-nav hidden">
      <div class="heading-container">
        <div class="heading">
          <div class="info">
            <div class="module">pcre2</div>
            <div class="toggle-version-container">
              <span>0.1.0 ac64318</span>
              <div id="dark-mode-toggle" role="switch" aria-checked="false" aria-label="Toggle dark mode"><svg xmlns="http://www.w3.org/2000/svg" class="light-icon" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="dark-icon" enable-background="new 0 0 24 24" height="24" viewBox="0 0 24 24" width="24"><g><rect fill="none" height="24" width="24"/></g><g><g><g><path d="M11.1,12.08C8.77,7.57,10.6,3.6,11.63,2.01C6.27,2.2,1.98,6.59,1.98,12c0,0.14,0.02,0.28,0.02,0.42 C2.62,12.15,3.29,12,4,12c1.66,0,3.18,0.83,4.1,2.15C9.77,14.63,11,16.17,11,18c0,1.52-0.87,2.83-2.12,3.51 c0.98,0.32,2.03,0.5,3.11,0.5c3.5,0,6.58-1.8,8.37-4.52C18,17.72,13.38,16.52,11.1,12.08z"/></g><path d="M7,16l-0.18,0C6.4,14.84,5.3,14,4,14c-1.66,0-3,1.34-3,3s1.34,3,3,3c0.62,0,2.49,0,3,0c1.1,0,2-0.9,2-2 C9,16.9,8.1,16,7,16z"/></g></g></svg>
</div>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg" id="toggle-menu" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>

          </div>
          <input type="text" id="search" placeholder="Search... (beta)" autocomplete="off">
        </div>
      </div>
      <nav class="search hidden"></nav>
      <nav class="content hidden">
        <ul>
          <li class="open"><a href="#readme_pcre2">README</a></li>
<li class="open"><a href="#compile">fn compile</a>        <ul>
</ul>
</li>
<li class="open"><a href="#escape_meta">fn escape_meta</a>        <ul>
</ul>
</li>
<li class="open"><a href="#must_compile">fn must_compile</a>        <ul>
</ul>
</li>
<li class="open"><a href="#Regex.free">type Regex</a>        <ul>
<li><a href="#Regex.free">fn free</a></li>
<li><a href="#Regex.find_match">fn find_match</a></li>
<li><a href="#Regex.find">fn find</a></li>
<li><a href="#Regex.matches">fn matches</a></li>
<li><a href="#Regex.replace_submatches_fn">fn replace_submatches_fn</a></li>
<li><a href="#Regex.replace_fn">fn replace_fn</a></li>
<li><a href="#Regex.replace">fn replace</a></li>
</ul>
</li>
<li class="open"><a href="#MatchData">struct MatchData</a>        <ul>
<li><a href="#MatchData.get">fn get</a></li>
<li><a href="#MatchData.get_all">fn get_all</a></li>
</ul>
</li>

        </ul>
      </nav>
    </header>
    <div class="doc-scrollview" id="main-content">
      <div class="doc-container">
        <div class="doc-content">
          						<section id="readme_pcre2" class="doc-node">
							<div class="title"><h1> pcre2 <a href="#readme_pcre2">#</a></h1></div><h1>pcre2</h1>
<p>A V library module for processing <a href="https://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions">Perl Compatible Regular Expressions (PCRE)</a> using the <a href="https://www.pcre.org/">PCRE2 library</a>.</p>
<ul>
<li>The <code>pcre2</code> module is a thin wrapper for the PCRE2 8-bit runtime library.</li>
<li>Currently there are no extraction methods for named subpatterns.</li>
<li>The <a href="https://github.com/vlang/pcre">pcre module</a> (which uses the older PCRE library) was the leading light for this project.</li>
<li>Many of the methods and functions were inspired by the <a href="https://pkg.go.dev/regexp">Go regex package</a>.</li>
</ul>
<h2>Documentation</h2>
<ul>
<li><a href="https://srackham.github.io/pcre2/pcre2.html">pcre2 module documentation</a>.</li>
<li><a href="https://www.pcre.org/current/doc/html/pcre2syntax.html">PCRE regular expressions syntax</a>.</li>
<li><a href="https://github.com/srackham/pcre2">Github repository</a></li>
</ul>
<h2>Examples</h2>
<pre><code class="language-v">import pcre2

fn main() {
    // Match words starting with `d` or `n`.
    r := pcre2.must_compile(r'\b([dn].*?)\b')

    subject := 'Lorem nisi dis diam a cras placerat natoque'

    // Extract array of all matched strings.
    a := r.find(subject, -1)
    println(a) // ['nisi', 'dis', 'diam', 'natoque']

    // Quote matched words.
    s1 := r.replace(subject, '&quot;$1&quot;', -1)
    println(s1) // 'Lorem &quot;nisi&quot; &quot;dis&quot; &quot;diam&quot; a cras placerat &quot;natoque&quot;'

    // Replace all matched strings with upper case.
    s2 := r.replace_fn(subject, fn (m string) string {
        return m.to_upper()
    }, -1)
    println(s2) // 'Lorem NISI DIS DIAM a cras placerat NATOQUE'
}
</code></pre>
<p>For more examples see inside the <a href="https://github.com/srackham/pcre2/tree/master/examples">examples directory</a> and take a look at the <a href="https://github.com/srackham/pcre2/blob/master/pcre2_test.v">module tests</a>.</p>
<h2>Dependencies</h2>
<p>Install the PCRE2 library:</p>
<p><strong>Arch Linux and Manjaro</strong>: <code>pacman -S pcre2</code></p>
<p><strong>Debian</strong>: <code>apt install libpcre2-dev</code></p>
<p><strong>Fedora</strong>: <code>yum install pcre2-devel</code></p>
<p><strong>macOS</strong>: <code>brew install pcre2</code></p>
<p><strong>Windows</strong> †: <code>pacman.exe -S mingw-w64-x86_64-pcre2</code></p>
<p>† This example is using the Windows <a href="https://www.msys2.org/">MSYS2</a> package management tools.</p>
<h2>Installation</h2>
<pre><code>v install --git https://github.com/srackham/pcre2
</code></pre>
<p>Test the installation by running:</p>
<pre><code>v test $HOME/.vmodules/pcre2
</code></pre>
<p>Example installation and test workflows for Ubuntu, macOS and Windows can be found in the Github Actions <a href="https://github.com/srackham/pcre2/blob/master/.github/workflows/ci.yml">workflow file</a>.</p>

</section>

						<section id="compile" class="doc-node">
							<div class="title"><h2>fn compile <a href="#compile">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">compile</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">?</span>Regex</code></pre>
<p><code>compile</code> parses a regular expression <code>pattern</code> and returns the corresponding <code>Regexp</code> struct.</p>

</section>
						<section id="escape_meta" class="doc-node">
							<div class="title"><h2>fn escape_meta <a href="#escape_meta">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">escape_meta</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span></code></pre>
<p><code>escape_meta</code> returns a string that escapes all regular expression metacharacters inside the argument text. The returned string is a regular expression matching the literal text.</p>

<section class="doc-node examples"><h4>Example</h4>
<pre><code class="language-v"><span class="token keyword">assert</span> <span class="token function">escape_meta</span><span class="token punctuation">(</span>r<span class="token string">'\.+*?()|[]{}^$'</span><span class="token punctuation">)</span> <span class="token operator">==</span> r<span class="token string">'\\\.\+\*\?\(\)\|\[\]\{\}\^\$'</span></code></pre>
</section>
</section>
						<section id="must_compile" class="doc-node">
							<div class="title"><h2>fn must_compile <a href="#must_compile">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token function">must_compile</span><span class="token punctuation">(</span>pattern <span class="token builtin">string</span><span class="token punctuation">)</span> Regex</code></pre>
<p><code>must_compile</code> is like <code>compile</code> but panics if the regex <code>pattern</code> cannot be parsed.</p>

</section>
						<section id="Regex.free" class="doc-node">
							<div class="title"><h2>fn (Regex) free <a href="#Regex.free">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p><code>free</code> disposes memory allocated to the PCRE2 compiled regex.<br>
If V's <code>-autofree</code> option is enabled V's autofree engine calls <code>free</code> automatically when it disposes the <code>Regex</code> struct.</p>

</section>
						<section id="Regex.find_match" class="doc-node">
							<div class="title"><h2>fn (Regex) find_match <a href="#Regex.find_match">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">find_match</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">,</span> pos <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">?</span>MatchData</code></pre>
<p><code>find_match</code> searches the <code>subject</code> string starting at index <code>pos</code> and returns a <code>MatchData</code> struct.<br>
If no match is found an error is returned.</p>

</section>
						<section id="Regex.find" class="doc-node">
							<div class="title"><h2>fn (Regex) find <a href="#Regex.find">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">find</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span></code></pre>
<p><code>find</code> returns an array containing matched strings from the <code>subject</code> string.</p>
<ul>
<li>If <code>n &gt;= 0</code>, then at most <code>n</code> matches are returned; otherwise, all matches are returned.</li>
</ul>

<section class="doc-node examples"><h4>Example</h4>
<pre><code class="language-v"><span class="token keyword">assert</span> <span class="token function">must_compile</span><span class="token punctuation">(</span>r<span class="token string">'\d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'1 abc 9 de 5 g'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">]</span></code></pre>
</section>
</section>
						<section id="Regex.matches" class="doc-node">
							<div class="title"><h2>fn (Regex) matches <a href="#Regex.matches">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">matches</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span></code></pre>
<p><code>matches</code> return <code>true</code> if the <code>subject</code> string contains a match for the regular expression; if no then <code>false</code> is returned.</p>

</section>
						<section id="Regex.replace_submatches_fn" class="doc-node">
							<div class="title"><h2>fn (Regex) replace_submatches_fn <a href="#Regex.replace_submatches_fn">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">replace_submatches_fn</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">,</span> repl <span class="token keyword">fn</span> <span class="token punctuation">(</span>matches <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span></code></pre>
<p><code>replace_submatches_fn</code> returns a copy of the <code>subject</code> string with regular expression matches replaced by the return value of the <code>repl</code> callback function.</p>
<ul>
<li>The <code>repl</code> function is passed a <code>matches</code> array containing the matched text (<code>matches[0]</code>) and any submatches (<code>matches[1..]</code>).</li>
<li>If a subpattern is not matched the corresponding <code>matches</code> element is set to ''.</li>
<li>If <code>n &gt;= 0</code>, then at most <code>n</code> matches are replaced; otherwise, all matches are replaced.</li>
</ul>

</section>
						<section id="Regex.replace_fn" class="doc-node">
							<div class="title"><h2>fn (Regex) replace_fn <a href="#Regex.replace_fn">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">replace_fn</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">,</span> repl <span class="token keyword">fn</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">string</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span></code></pre>
<p><code>replace_fn</code> returns a copy of the <code>subject</code> string with regular expression matches replaced by the return value of the <code>repl</code> callback function.</p>
<ul>
<li>The <code>repl</code> function is passed a string containing the matched text.</li>
<li>If <code>n &gt;= 0</code>, then at most <code>n</code> matches are replaced; otherwise, all matches are replaced.</li>
</ul>

</section>
						<section id="Regex.replace" class="doc-node">
							<div class="title"><h2>fn (Regex) replace <a href="#Regex.replace">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>r <span class="token operator">&</span>Regex<span class="token punctuation">)</span> <span class="token function">replace</span><span class="token punctuation">(</span>subject <span class="token builtin">string</span><span class="token punctuation">,</span> repl <span class="token builtin">string</span><span class="token punctuation">,</span> n <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">string</span></code></pre>
<p><code>replace</code> returns a copy of the <code>subject</code> string in which matches of the regular expression are replaced by the <code>repl</code> string.</p>
<ul>
<li><code>$0</code>...<code>$99</code> in the <code>repl</code> string are replaced by matching text; the number zero refers to the entire matched substring; higher numbers refer to substrings captured by parenthesized subpatterns e.g. <code>$1</code> refers to the first submatch.</li>
<li>References to undefined subpatterns are not replaced.</li>
<li>Subpatterns that did not participate in the match replaced with ''.</li>
<li>To insert a literal <code>$</code> in the output, use <code>$$</code>.</li>
<li>If <code>n &gt;= 0</code>, then at most <code>n</code> matches are replaced; otherwise, all matches are replaced.</li>
</ul>

</section>
						<section id="MatchData" class="doc-node">
							<div class="title"><h2>struct MatchData <a href="#MatchData">#</a></h2></div><pre class="signature"><code><span class="token keyword">struct</span> <span class="token symbol">MatchData</span> <span class="token punctuation">{</span>
	subject <span class="token builtin">string</span>
	ovector <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token punctuation">}</span></code></pre>
<p><code>MatchData</code> an struct containing match results; it is returned by the <code>Regex.find_match</code> method.</p>
<ul>
<li><code>subject</code> is the searched string.</li>
<li><code>ovector</code> is an array of start/end index pairs specifying the byte offsets of the match and submatches in the <code>subject</code> string.<br>
<code>ovector[0]</code> and <code>ovector[1]</code> are the start and end indexes of the entire match.<br>
<code>ovector[2*N]</code> and <code>ovector[2*N+1]</code> are the start and end indexes of the Nth submatch</li>
<li>If a subpattern did not participate in the match the start and end indexes will be <code>-1</code>.</li>
</ul>

</section>
						<section id="MatchData.get" class="doc-node">
							<div class="title"><h2>fn (MatchData) get <a href="#MatchData.get">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>m MatchData<span class="token punctuation">)</span> <span class="token function">get</span><span class="token punctuation">(</span>number <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">?</span><span class="token builtin">string</span></code></pre>
<p><code>get</code> returns captured match and submatch strings by <code>number</code>. The number zero refers to the entire match, with numbers 1.. referring to parenthesized subpatterns.</p>
<ul>
<li>Returns '' if the subpattern was not captured.</li>
<li>Returns an error if <code>number</code> is less than zero or greater than the total number of subpatterns.</li>
</ul>

</section>
						<section id="MatchData.get_all" class="doc-node">
							<div class="title"><h2>fn (MatchData) get_all <a href="#MatchData.get_all">#</a></h2></div><pre class="signature"><code><span class="token keyword">fn</span> <span class="token punctuation">(</span>m MatchData<span class="token punctuation">)</span> <span class="token function">get_all</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span></code></pre>
<p><code>get_all</code> returns an array containing match an submatch strings:</p>
<ul>
<li>The first element (at index 0) contains the the entire matched text.</li>
<li>Subsequent elements (indexes 1..) contain corresponding matched subpatterns</li>
<li>If a subpattern is not matched the corresponding array element is set to ''.</li>
</ul>

</section>

          <div class="footer">
            Powered by vdoc. Generated on: 11 Oct 2022 21:49:24
          </div>
        </div>
        
      </div>
    </div>
  </div>
  <script src="doc.js"></script>
  <script async src="search_index.js"></script>
</body>

</html>
